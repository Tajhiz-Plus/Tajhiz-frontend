"use strict";(self.webpackChunktajhiz_dashboard_react=self.webpackChunktajhiz_dashboard_react||[]).push([[5],{2982:(e,r,s)=>{s.d(r,{G:()=>a});var n=s(6546),i=s(315),o=s(6965);const t=[{scope:i.e.PERMISSIONS}],a=()=>(0,n.I)({queryKey:t,queryFn:o.VE})},5005:(e,r,s)=>{s.r(r),s.d(r,{default:()=>F});var n=s(9950),i=s(6491),o=s(4446),t=s(6310),a=s(2053),d=s(3962),l=s(226),c=s(6639),u=s(8157),h=s(9983),x=s(8429),v=s(2982),p=s(6546),A=s(315),j=s(1728);const m=e=>[{scope:A.e.ROLE_DETAILS,roleId:e}];var y=s(3125),g=s(4414);function f(e){let{rows:r=10}=e;return(0,g.jsx)(i.A,{children:Array.from({length:r}).map(((e,r)=>(0,g.jsxs)(o.Ay,{divider:!0,sx:{py:.5,px:1.5},children:[(0,g.jsx)(y.A,{variant:"rounded",width:20,height:20,sx:{borderRadius:"4px",flexShrink:0}}),(0,g.jsxs)(i.A,{sx:{mx:1,width:"100%"},children:[(0,g.jsx)(y.A,{variant:"text",width:"35%",height:22}),(0,g.jsx)(y.A,{variant:"text",width:"18%",height:16,sx:{mt:.5}})]})]},r)))})}var E=s(5441),I=s(1778);var w=s(1201);const F=function(){var e,r,s;const[y,F]=(0,n.useState)([]),{id:S}=(0,x.g)(),b=(0,x.Zp)(),{data:k,isLoading:C}=(L=S,(0,p.I)({queryKey:m(L),queryFn:()=>(0,j.dH)(L),enabled:!!L}));var L;const{data:R,isLoading:_}=(0,v.G)(),{mutate:q,isPending:K}=(e=>{let{onSuccess:r,onError:s}=e;const n=(0,E.jE)();return(0,I.n)({mutationFn:e=>{let{roleId:r,permissions:s}=e;return(0,j.Ul)(r,s)},onSuccess:(e,s,i)=>{var o;n.invalidateQueries({queryKey:(o=s.roleId,[{scope:A.e.ROLE_DETAILS,roleId:o}])}),null===r||void 0===r||r(e,s,i)},onError:(e,r,n)=>{console.error("Error updating role permissions",e),null===s||void 0===s||s(e,r,n)}})})({onSuccess:()=>{w.oR.success("\u062a\u0645 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u062f\u0648\u0631 \u0628\u0646\u062c\u0627\u062d"),b("/roles")},onError:e=>{w.oR.error("\u062d\u062f\u062b \u062e\u0637\u0623: ".concat(e.message))}}),z=(null===R||void 0===R||null===(e=R.data)||void 0===e?void 0:e.permissions)||[],O=(null===k||void 0===k||null===(r=k.data)||void 0===r||null===(s=r.role)||void 0===s?void 0:s.rolePermissions)||[];return(0,n.useEffect)((()=>{O.length&&F(O.map((e=>e.permissionId)))}),[O]),(0,g.jsxs)(u.A,{children:[(0,g.jsx)(h.A,{}),_||C?(0,g.jsx)(f,{rows:15}):(0,g.jsxs)(i.A,{children:[z.map((e=>{const r=y.includes(e.id);return(0,g.jsxs)(o.Ay,{divider:!0,sx:{py:.5,px:1.5},children:[(0,g.jsx)(t.A,{edge:"start",checked:r,onChange:()=>{return r=e.id,void F((e=>e.includes(r)?e.filter((e=>e!==r)):[...e,r]));var r}}),(0,g.jsxs)(i.A,{sx:{mx:1},children:[(0,g.jsx)(a.A,{variant:"body2",fontWeight:600,children:e.nameAr}),(0,g.jsxs)(a.A,{variant:"caption",color:"text.secondary",children:["(",e.key,")"]})]})]},e.id)})),(0,g.jsxs)(d.A,{direction:"row",spacing:1,sx:{mt:3},justifyContent:"flex-start",children:[(0,g.jsx)(l.A,{variant:"contained",sx:{color:"#FFF"},onClick:()=>{q({roleId:S,permissions:y})},children:K?(0,g.jsx)(c.A,{size:22,sx:{color:"#FFF"}}):"\u062d\u0641\u0638"}),(0,g.jsx)(l.A,{variant:"outlined",sx:{color:"#000",borderColor:"#000","&:hover":{borderColor:"#000"}},onClick:()=>b("/roles"),children:"\u0627\u0644\u063a\u0627\u0621"})]})]})]})}},6965:(e,r,s)=>{s.d(r,{Ft:()=>t,LA:()=>o,VE:()=>i,pK:()=>a});var n=s(9591);const i=async()=>(await n.A.get("/api/v1/permissions")).data,o=(e,r)=>n.A.put("/api/v1/permissions/".concat(e),r).then((e=>e.data)),t=e=>n.A.post("/api/v1/permissions",e).then((e=>e.data)),a=e=>n.A.delete("/api/v1/permissions/".concat(e)).then((e=>e.data))}}]);